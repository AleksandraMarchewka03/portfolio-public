const translations = {
  en: {
    name: "Aleksandra Marchewka",
    home: "Home",
    allProjects: "All Projects",
    contact: "Contact",
    settings: "Settings",
    colorMode: "Color Mode",
    darkMode: "Dark Mode",
    lightMode: "Light Mode",
    language: "Language",
    greeting: "Hello! I am Aleksandra Marchewka. I am a Software Developer.",
    bio: "I've been coding since I was 13 and recently finished my undergraduate degree in computer science. I have an interest in fullstack development and machine learning.",
    seeMyWork: "See my work",
    checkResume: "Check Out My Resume",
    myStack: "My Stack",
    recentWork: "Recent Work",
    recentWorkText: "Currently I am refactoring and improving my projects from university. Links to completed work will be added shortly.",
    proj1Title: "Emotion-Driven Unity Game",
    proj1Desc: "Dissertation project combining facial emotion detection, eye tracking and speech recognition to drive adaptive gameplay in Unity.",
    proj2Title: "Android Trivia App",
    proj2Desc: "Mobile trivia game with randomised questions, scoring feedback, and external REST API integration. Tested across multiple devices.",
    proj3Title: "Web Forum Application",
    proj3Desc: "Full-stack forum platform with authentication, posting, commenting, and admin/moderation features. Containerised with Docker.",
    proj4Title: "Object Recognition (CIFAR-100)",
    proj4Desc: "Image recognition pipeline achieving over 70% accuracy on the CIFAR-100 dataset, built using Java and computer vision techniques.",
    viewProject: "View Project",
    viewDetails: "View Details",
    searchPlaceholder: "Search projects...",
    proj5Title: "2D Game in Unity",
    proj5Desc: "Designed and implemented a 2D game featuring physics-based mechanics and dynamic enemy behaviour, scripted in C#.",
    proj6Title: "2D Jewel Chase Game",
    proj6Desc: "Team project building a 2D desktop game with animations, scoring, and smooth UX. Used Git for version control and collaboration.",
    cvTitle: "My Resume",
    downloadResume: "Download Resume",
    downloadEnglish: "Download English Version",
    downloadPolish: "Download Polish Version",
    linkedin: "LinkedIn",
    cv: "CV",
    github: "GitHub",
    copyright: "Â© 2025 Aleksandra Marchewka",
    languageNotice: "ğŸŒ Available in English and Polish",
    // Contact page
    contactTaglinePart1: "BSc Computer Science Â· Swansea University Â· 2:1 Hons",
    contactTaglinePart2: "Based in London Â· Open to relocation to Poland",
    contactTagline: "BSc Computer Science Â· Swansea University Â· 2:1 Hons Â· Based in London Â· Open to relocation to Poland",
    formNamePlaceholder: "Jane Smith",
    formEmailPlaceholder: "jane@example.com",
    formContactPlaceholder: "Phone number, LinkedIn URLâ€¦",
    formMessagePlaceholder: "Hi Aleksandra, I'd love to chat aboutâ€¦",
    contactLocation: "London N4, UK",
    contactRelocation: "Open to relocation to KrakÃ³w / Warsaw, Poland",
    contactUni: "Swansea University",
    contactDegree: "Computer Science BSc Â· 2:1 with Honours",
    pleaseText: "please text",
    getInTouch: "Get in touch",
    formName: "Your name",
    formEmail: "Your email",
    formContact: "Best way to reach you back",
    formOptional: "(optional)",
    formMessage: "Message",
    sendMessage: "Send Message",
  },
  pl: {
    name: "Aleksandra Marchewka",
    home: "Strona GÅ‚Ã³wna",
    allProjects: "Wszystkie Projekty",
    contact: "Kontakt",
    settings: "Ustawienia",
    colorMode: "Tryb KolorÃ³w",
    darkMode: "Tryb Ciemny",
    lightMode: "Tryb Jasny",
    language: "JÄ™zyk",
    greeting: "CzeÅ›Ä‡! Jestem Aleksandra Marchewka. Jestem ProgramistkÄ….",
    bio: "ProgramujÄ™ od 13 roku Å¼ycia i niedawno ukoÅ„czyÅ‚am studia licencjackie z informatyki. InteresujÄ™ siÄ™ programowaniem full-stack i uczeniem maszynowym.",
    seeMyWork: "Zobacz moje prace",
    checkResume: "SprawdÅº moje CV",
    myStack: "MÃ³j Stack",
    recentWork: "Ostatnie Prace",
    recentWorkText: "Obecnie refaktoryzujÄ™ i ulepszam moje projekty z uniwersytetu. Linki do ukoÅ„czonych prac zostanÄ… dodane wkrÃ³tce.",
    proj1Title: "Gra Unity sterowana emocjami",
    proj1Desc: "Projekt dyplomowy Å‚Ä…czÄ…cy detekcjÄ™ emocji twarzy, Å›ledzenie wzroku i rozpoznawanie mowy w celu adaptacyjnej rozgrywki w Unity.",
    proj2Title: "Aplikacja trivia na Androida",
    proj2Desc: "Mobilna gra trivia z losowymi pytaniami, ocenÄ… wynikÃ³w i integracjÄ… z zewnÄ™trznymi API REST. Testowana na wielu urzÄ…dzeniach.",
    proj3Title: "Forum internetowe",
    proj3Desc: "PeÅ‚noprawna platforma forum z uwierzytelnianiem, publikowaniem, komentowaniem i funkcjami moderacji. Skonteneryzowana z Dockerem.",
    proj4Title: "Rozpoznawanie obiektÃ³w (CIFAR-100)",
    proj4Desc: "Pipeline rozpoznawania obrazÃ³w osiÄ…gajÄ…cy ponad 70% dokÅ‚adnoÅ›ci na zbiorze CIFAR-100, zbudowany w Javie z technikami computer vision.",
    viewProject: "Zobacz Projekt",
    viewDetails: "Zobacz SzczegÃ³Å‚y",
    searchPlaceholder: "Szukaj projektÃ³w...",
    proj5Title: "Gra 2D w Unity",
    proj5Desc: "Projektowanie i implementacja gry 2D z mechanikÄ… opartÄ… na fizyce i dynamicznymi zachowaniami przeciwnikÃ³w, skryptowanej w C#.",
    proj6Title: "Gra 2D Jewel Chase",
    proj6Desc: "Projekt zespoÅ‚owy â€” gra desktopowa 2D z animacjami, punktacjÄ… i pÅ‚ynnym UX. Kontrola wersji i wspÃ³Å‚praca przez Git.",
    cvTitle: "Moje CV",
    downloadResume: "Pobierz CV",
    downloadEnglish: "Pobierz WersjÄ™ AngielskÄ…",
    downloadPolish: "Pobierz WersjÄ™ PolskÄ…",
    linkedin: "LinkedIn",
    cv: "CV",
    github: "GitHub",
    copyright: "Â© 2025 Aleksandra Marchewka",
    languageNotice: "ğŸŒ DostÄ™pne po angielsku i po polsku",
    // Contact page
    contactTaglinePart1: "Licencjat Informatyki Â· Swansea University Â· 2:1 z wyrÃ³Å¼nieniem",
    contactTaglinePart2: "Londyn Â· Otwarta na relokacjÄ™ do Polski",
    contactTagline: "Licencjat Informatyki Â· Swansea University Â· 2:1 z wyrÃ³Å¼nieniem Â· Londyn Â· Otwarta na relokacjÄ™ do Polski",
    formNamePlaceholder: "Jan Kowalski",
    formEmailPlaceholder: "jan@przykÅ‚ad.pl",
    formContactPlaceholder: "Numer telefonu, LinkedIn URLâ€¦",
    formMessagePlaceholder: "CzeÅ›Ä‡ Aleksandro, chciaÅ‚bym/chciaÅ‚abym porozmawiaÄ‡ oâ€¦",
    contactLocation: "Londyn N4, Wielka Brytania",
    contactRelocation: "Otwarta na relokacjÄ™ do Krakowa / Warszawy",
    contactUni: "Swansea University",
    contactDegree: "Informatyka BSc Â· 2:1 z wyrÃ³Å¼nieniem",
    pleaseText: "proszÄ™ pisaÄ‡ SMS",
    getInTouch: "Skontaktuj siÄ™",
    formName: "Twoje imiÄ™",
    formEmail: "TwÃ³j adres e-mail",
    formContact: "Najlepszy sposÃ³b kontaktu",
    formOptional: "(opcjonalne)",
    formMessage: "WiadomoÅ›Ä‡",
    sendMessage: "WyÅ›lij wiadomoÅ›Ä‡",
  }
};

function getCurrentLanguage() {
  return localStorage.getItem('language') || 'en';
}

function setLanguage(lang) {
  localStorage.setItem('language', lang);
  applyTranslations();
}

// Single, dead-simple translation function â€” no clever branching
function applyTranslations() {
  const lang = getCurrentLanguage();
  const t = translations[lang];

  document.querySelectorAll('[data-translate]').forEach(function(el) {
    var key = el.getAttribute('data-translate');
    var val = t[key];
    if (val === undefined) return;

    // Walk child nodes and update text nodes only â€” never touch element children
    var textNodeFound = false;
    for (var i = 0; i < el.childNodes.length; i++) {
      var node = el.childNodes[i];
      if (node.nodeType === 3) { // TEXT_NODE
        node.nodeValue = val;
        textNodeFound = true;
        break;
      }
    }
    // No text node at all (empty element) â€” just set textContent
    if (!textNodeFound) {
      el.textContent = val;
    }
  });

  // Translate placeholders
  document.querySelectorAll('[data-translate-placeholder]').forEach(function(el) {
    var key = el.getAttribute('data-translate-placeholder');
    var val = t[key];
    if (val !== undefined) el.placeholder = val;
  });

  // Update language indicator
  var indicator = document.getElementById('current-lang');
  if (indicator) indicator.textContent = lang === 'en' ? 'EN' : 'PL';

  var langText = document.getElementById('lang-text');
  if (langText) {
    langText.innerHTML = lang === 'en' ? '<strong>ENG</strong> / PL' : 'ENG / <strong>PL</strong>';
  }

  var langToggle = document.getElementById('language-toggle');
  if (langToggle) langToggle.checked = lang === 'pl';

  document.documentElement.lang = lang;
}

// Keep updatePageLanguage as alias so script.js calling initializeLanguage still works
function updatePageLanguage() { applyTranslations(); }

var _langInitDone = false;
function initializeLanguage() {
  applyTranslations();
  if (_langInitDone) return;
  _langInitDone = true;

  var langToggle = document.getElementById('language-toggle');
  if (langToggle) {
    langToggle.addEventListener('change', function() {
      setLanguage(langToggle.checked ? 'pl' : 'en');
    });
  }
}

// Also run after full page load as a failsafe
window.addEventListener('load', applyTranslations);